4. Sequences of Cabinets. For each country, report the cabinets formed over time


select cab.id as "cabinet id", c.name, cab.name as leader, cab.start_date, ed.enddate
from cabinet cab join country c on c.id = cab.country_id
full join enddate ed on cab.id = ed.id
order by c.name desc, cab.start_date asc;

# finding end date
create view enddate as
select c2.id, c.start_date as enddate
from cabinet c, cabinet c2
where c.previous_cabinet_id = c2.id;
